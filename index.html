<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>D3 Test</title>
		<style>
		div.bar {
			display: inline-block;
			border-style: solid;
			border-color: white;
			border-width: 0.5px;
			width: 40px;
			height: 75 px;
			background-color: blue;}
			
		</style>
        <script type="text/javascript" src="d3/d3.js"></script>
    </head>
    <body>
		
		
        <script type="text/javascript">
		var a = 2.5;
		var b = 1;
		function go2(histo,dataset,numbin){
			var maxHisto = d3.max(histo);
			var minHisto = d3.min(histo);
			
			var maxData = d3.max(dataset);
			var minData = d3.min(dataset);
			
			var h3 = 500;
			var w3 = 750;
			
			
			var yScale = d3.scaleLinear()
						.domain([minHisto, maxHisto+(1-histo[0])/20])
						.range([0, h3]);
			
			
			var svg2 = d3.select("body")
			.append("svg")
			.attr("width", w3)
			.attr("height", h3);
			
			
			var recta = svg2.selectAll("rect")
			.data(histo)
			.enter()
			.append("rect")
			.attr('x', function(d,i){
				return i * (w3/numbin); })
			.attr("y",function(d){
				return h3 - yScale(d)- 25; })
			.attr("width", w3/numbin - 2)
			.attr("height", function(d){
				return yScale(d); })
			.attr("fill", "blue")
			.on("mouseover", function(d) {
				d3.select(this)
				.attr("fill","orange");	})
			.on("mouseout", function(d) {
				d3.select(this)
				.transition()
				.duration(500)
				.attr("fill","blue"); });
					
			
			svg2.selectAll("text")
				.data(histo)
				.enter()
				.append("text")
				.text(function(d,i){
					if(d > 0.03 && i % 2 == 0){
						return Math.round(d * 100) / 100}
					else {
						return ""}})
				.attr("x", function(d,i){
					return i * (w3 / histo.length);})
				.attr("y", function(d){
					return h3 - yScale(d)-30;});
			
			var xScale = d3.scaleLinear()
						//.domain([1, numbin])
						.domain([minData, maxData])
						.range([0, w3]);
			
			var xAxis = d3.axisBottom()
							.scale(xScale)
							.ticks(10);
			var yAxis = d3.axisRight()
							.scale(yScale)
							.ticks(5);
			svg2.append("g")
			.attr("transform", "translate(0,"+(h3-20)+")")
			.call(xAxis);
			// svg2.append("g")
			// .attr("transform", "translate("+20+",0)")
			// .call(yAxis);

			
			d3.select("body")
			.append("hr")
			
			console.log(maxData)
			console.log(minData) }
		
		function goHist(a,b){
            var dataset = [];
			var fataset = [];
			

			for(var i = 0; i < 10000; i++) {
				var numb = Math.random();
				fataset.push(numb);
				dataset.push(b*Math.pow(1-numb, -1/a));}
			// console.log(fataset)
			var k = 0;
			var histo = [];
			var c; 			
			var numbin = 75
			var minN = Math.min.apply(null, dataset)
			var maxN = Math.max.apply(null, dataset)
			dataset = dataset.filter(function(x) { return x < maxN/8; });
			maxN = Math.max.apply(null, dataset)
			var widthbin = (maxN-minN) / numbin
			for( var j = 1; j < numbin+1; j++){
				c = 0;
				 console.log("bin "+j)
				for (var x = 0; x < dataset.length; x++){
			    	 // console.log("check " +dataset[x] +" in ["+k*widthbin+","+(k+1)*widthbin +"]" )

					if(dataset[x]>=minN+(k*widthbin) && dataset[x]<=minN+(k+1)*widthbin){
						console.log("yeah: " +dataset[x] +" in ["+(minN+(k*widthbin))+","+(minN+(k+1)*widthbin) +"]" )

						c = c + 1;}}
				histo.push(c/dataset.length);
				k = k+1; }
			
			// console.log(histo.reduce((a, b) => a + b, 0))
			// console.log(histo)
			d3.select("body")
				.append("h1")
				.attr("align","center")
				.text("Simulation of Pareto("+a+", " +b+")");
			go2(histo,dataset,numbin);}
			goHist(a,b)
			</script>
			<input id='lol1' type='text'>
			<input id='lol2' type='text'>
			<button onClick='changelol()'>Change</button>
			<script>
			function changelol(){
			var intup1 = document.getElementById('lol1').value;
			var intup2 = document.getElementById('lol2').value;
			a = intup1;
			b = intup2;
			goHist(a,b)}
			
			d3.select("body")
			.append("hr")
			//selection=(numbin/2+1)
			//histo = histo.slice(0, selection)
			//numbin = histo.length
			//dataset = dataset.filter(function(x) { return x < selection*widthbin+minN; });
			
			
			</script>
    </body>
</html> 